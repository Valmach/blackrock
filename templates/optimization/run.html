{% extends "optimization/base_optimization.html" %} 

{% block tabname %}tab-leaf{% endblock %} 

{% block js %}
  {{ block.super }}
  <script type="text/javascript" src="/site_media/js/tablesort.js"></script>
  <script type="text/javascript" src="/site_media/js/local_session.js"></script>
  <script type="text/javascript" src="media/js/sample_storage.js"></script>
  <script type="text/javascript" src="media/js/run.js"></script>
  <script type="text/javascript" src="media/js/toggles.js"></script>
  <script type="text/javascript" src="media/js/area.js"></script>
  <script type="text/javascript" src="http://openlayers.org/api/2.9/OpenLayers.js"></script>
  <!--script type="text/javascript" src="media/js/OpenLayers.js"></script-->
  <!--script type="text/javascript" src="media/js/openlayers/lib/OpenLayers.js"></script-->
  <script type="text/javascript" src="media/js/map.js"></script>
{% endblock %}

{% block content %}

<div class="toggle-container" id="parameters">
  <div class="inner toggle-nest">
    <div class="right">
      <div id="results-map-container" class="map">
        <div id="map-select-plot"></div>
        <div id="results-map" style="width:380px;height:300px;"><!-- 
           VERY IMPORTANT THAT THE WIDTH/HEIGHT STAY HERE
             OTHERWISE OPENLAYERS DOESN'T WORK
        --></div>
      </div>
      <div class="generalinfo">
        <h4>About the Virtual Forest</h4>
        Grid size: 7.3ha (300m x 225m / 67,500m<sup>2</sup>)
        <br />
        Base Dataset: North Slope Plot
        <br />
        Data Collection Year: 2007
      </div>

  
    </div>

    <div class='runtable' id="run-interface">
      <form name="runform" id='runform'>
      <table>
        <thead>
          <tr>
            <th class="Number">No. of plots</th>
            <th>Shape</th>
            <th class="Number"><span id='shapeLabel'>Radius</span>(m)</th>
            <th>Arrangement</th>
            <th class="Number">Sample Area</th>
            <th><input type="reset" value="Reset" id="reset" /></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input name="numPlots" type='text' id='numPlots' size='5' value='1' /></td>
            <td>
              <select name="shape" id='plotShape'>
                <option value="circle">Circle</option>
                <option value="square">Square</option>
              </select>
            </td>
            <td><input name="size" type='text' id='plotSize' size='5' value='3' /></td>
            <td>
              <select name="plotArrangement" id='plotArrangement'>
                <option value='random'>Randomize</option>
                <!--option value='random'>Straight Line</option-->
                <!--option value='random'>Two Parallel Lines</option-->
                <option value='grid'>Grid</option>
              </select>
            </td>
            <td>
              <span id='plotArea'></span>m<sup>2</sup>
            </td>
            <td><input type="button" value="Calculate" id="calculate" /></td>
          </tr>
        </tbody>
      </table>
      </form>

      <h3>Sampling History <span class="heading-addendum">(stored in your web browser)</span></h3>
      <div id="sample-list-table">
      <table class="sortable" onclick="sortColumn(event)">
        <thead>
          <tr>
            <th class="Number">Run</th>
            <th class="Number"># plots</th>
            <th>Shape</th>
            <th class="Number">Edge/ Radius (m)</th>
            <th>Arrange- ment</th>
            <th class="Number">Total sample area</th>
            <th class="human_time">Sample Time (min)</th>
            <th class="human_time">Average time per plot</th>
            <th class="Number">Sample variance density</th>
            <th class="Number">Sample variance basal area</th>
          </tr>
        </thead>
        <tbody id="sample-list">
        </tbody>
      </table>
      </div>
    </div><!-- id=run-interface -->
    
  </div> <!-- end div "inner" -->

</div>

<div class="container" id="waitmessage">
  Calculating results, please wait...
</div>

<div class="container" id="errormessage">
  Sorry, the calculation encountered an error.  
  <div id="customerror"></div>
  Please try again.
</div>
<div id="results">
<h2>Sampling Results</h2>
<div id="csv">
  <form id="csvform" action="csv" method="POST">
    Export to CSV:
    <input type="hidden" name="results" id="form-results" />
    <select name="type">
      <option value="summary">summary</>
      <option value="details">details</option>
    </select>
    <input type="button" id='csvbutton' value="Export Now!" onclick="javascript:getcsv();" />
  </form>
</div><!-- csv -->
    
<div class="container toggle-container" id="results_summary">
  <h3 class="toggle-control"><span class='downarrow'>&#x25BE;</span>
      <span class='rightarrow'>&#x25B8</span>
     Total Run Results (Click to Expand/Collapse)</h3>
  <div class="toggle-nest">
  <!-- h4>Summary</h4>
  <table class="results-summary">
    <tr>
      <td class='header'>TIME TO SAMPLE</td>
      <td class='right'><span id='results-time'></span></td>
    </tr>
    <tr>
      <td class='header'>AVERAGE TIME PER PLOT</td>
      <td class='right'><span id='results-avg-time'></span></td>
    </tr>
    <tr>
      <td class='header'>SAMPLE VARIANCE DENSITY</td>
      <td id='results-variance-density' class='right'></td>
    </tr>
    <tr>
      <td class='header'>SAMPLE VARIANCE BASAL AREA</td>
      <td id='results-variance-basal' class='right'></td>
    </tr>
  </table -->
<h4>Details</h4>
  <table class='results'>
    <thead>
      <tr>
        <td></td>
        <td>AREA (m<sup>2</sup>)</td>
        <td>SPECIES</td>
        <td># OF TREES</td>
        <td>MEAN DBH (cm)</td>
        <td>VARIANCE DBH</td>
        <td>DENSITY (N/ha)</td>
        <td>BASAL AREA (m<sup>2</sup>/ha)</td>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td class='header'>SAMPLE PLOTS</td>
        <td id='results-area' class='right'></td>
        <td id='results-species' class='right'></td>
        <td id='results-count' class='right'></td>
        <td id='results-dbh' class='right'></td>
        <td id='results-variance-dbh' class='right'></td>
        <td id='results-density' class='right'></td>
        <td id='results-basal' class='right'></td>
      </tr>
      <tr>
        <td class='header'>FOREST POPULATION</td>
        <td id='actual-area' class='right'></td>
        <td id='actual-species' class='right'></td>
        <td id='actual-count' class='right'></td>
        <td id='actual-dbh' class='right'></td>
        <td id='actual-variance-dbh' class='right'></td>
        <td id='actual-density' class='right'></td>
        <td id='actual-basal' class='right'></td>
      </tr>
      <tr>
        <td class='header'>COMPARISON</td>
        <td id='comparison-area' class='right'></td>
        <td id='comparison-species' class='right'></td>
        <td id='comparison-count' class='right'></td>
        <td id='comparison-dbh' class='right'></td>
        <td id='comparison-variance-dbh' class='right'></td>
        <td id='comparison-density' class='right'></td>
        <td id='comparison-basal' class='right'></td>
      </tr>
    </tbody>
  </table><!-- end inner table -->
  </div><!-- end div nest -->
</div><!-- end div container -->

<div class="container" id="details">
  <!--h3 class="toggle"><span class='downarrow'>&#x25BE;</span>
      <span class='rightarrow'>&#x25B8</span>
      Sampling Details</h3-->
  <h3>Plot by Plot Results</h3>
  <div id='plot-parent'>
  </div>
    <div class='plot-wrapper' id='plot-template'>
      <div class='plot-info toggle-container'>
        <div class='plot-title'>
        PLOT 1:</div>
        <h4>Summary</h4>
        <table class="results-summary">
          <tr><td class='header'>AREA (m<sup>2</sup>)</td><td class='header'># OF TREES</td><td class='header'>TIME TO SAMPLE</td></tr>
          <tr><td id='plot1-area' class='right'></td> <td class='right'><span id='plot1-count'></span></td>  <td class='right'><span id='plot1-time-total'></span> min</td></tr>
          
        </table>
    
        <div class='subdetails'>
          <h4 class='toggle-control'><span class='downarrow' style="display:none;">&#x25BE;</span>
          <span class='rightarrow' style="display:inline;">&#x25B8</span> Details (Click to Expand/Collapse)</h4>
          
          <div class='toggle-nest' style='display:none;'>
            
            <table class="results-summary">
              <tr>
                <td class='header'>Time Spent...</td>
                <td></td>
              </tr>
              <tr>
                <td class='subheader right'>Locating Plot</td>
                <td class='right'><span id='plot1-time-locate'></span> min</td>
              </tr>
              <tr>
                <td class='subheader right'>Traveling to Plot Area</td>
                <td class='right'><span id='plot1-time-travel'></span> min</td>
              </tr>
              <tr>
                <td class='subheader right'>Establishing Plot</td>
                <td class='right'><span id='plot1-time-establish'></span> min</td>
              </tr>
              <tr>
                <td class='subheader right'>Measuring Trees</td>
                <td class='right'><span id='plot1-time-measure'></span> min</td>
              </tr>
            </table>
            
            <table class='results'>
              <thead>
                <tr>
                  <td>SPECIES</td>
                  <td># OF TREES</td>
                  <td>MEAN DBH (cm)</td>
                  <td>VARIANCE DBH</td>
                  <td>DENSITY (N/ha)</td>
                  <td>BASAL AREA (m<sup>2</sup>/ha)</td>
                </tr>
              </thead>
              <tbody id='plot1-species-table'>
                <tr>
                  <td><strong>TOTAL: <span id='plot1-species'></span></strong></td>
                  <td id='plot1-details-count' class='right'></td>
                  <td id='plot1-dbh' class='right'></td>
                  <td id='plot1-variance-dbh' class='right'></td>
                  <td id='plot1-density' class='right'></td>
                  <td id='plot1-basal' class='right'></td>
                </tr>
              </tbody>
            </table>
            </div><!-- end div subdetails --->
          </div><!-- end div toggle-nest -->

        </div><!-- end div plot-info -->
      </div><!-- end div class=plot-wrapper -->

  </div> <!-- end div all_results -->
</div><!-- end div container -->



{% endblock %}