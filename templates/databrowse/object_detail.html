{% extends "portal/base_portal.html" %}
{% load smartif %}
{% load klass %}

{% block title %}{{ object.model.verbose_name|capfirst }}: {{ object }}{% endblock %}

{% block js %}
{{ block.super }}
<script type="text/javascript" src="/site_media/js/mochikit/MochiKit/MochiKit.js"></script> 
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
    function addMarkers() {
        var markerCount = 0

        // Add markers for the currently viewed object.
        
        {% if object.instance.latitude %}
           markerCount += addMarker({{object.instance.latitude}}, {{object.instance.longitude}}, map, "{{object.instance.name}}", "{{object.instance|klass|lower}}", "{{object.instance.description|truncatewords:20}}", {{object.instance.id}}, true);
        {% endif %}

        {% if object.instance.location %}
           {% for loc in object.instance.location.all %}
              markerCount += addMarker({{loc.latitude}}, {{loc.longitude}}, map, "{{loc.name}}", "location", "{{loc.description|truncatewords:20}}", {{loc.id}}, {% ifequal forloop.counter 1 %} true {% else %} false {% endifequal %});
           {% endfor %}
        {% endif %}

        // Add markers for related objects
        {% for related_object in object.related_objects %}
           {% for robject in related_object.object_list %}
               {% if robject.instance.latitude %}
                  markerCount += addMarker({{robject.instance.latitude}}, {{robject.instance.longitude}}, map, "{{robject.instance.name}}", "{{robject.instance|klass|lower}}", "{{robject.instance.description|truncatewords:20}}", {{robject.instance.id}}, false);
               {% endif %}
        
               // Indirect reference to a location
               {% if robject.instance.location %}
                  {% for loc in robject.instance.location.all %}
                     markerCount += addMarker({{loc.latitude}}, {{loc.longitude}}, map, "{{robject.instance.name}}", "{{robject.instance|klass|lower}}", "{{robject.description|truncatewords:20}}", {{robject.instance.id}}, false)
                  {% endfor %}
               {% endif %}
           {% endfor %}
        {% endfor %}

        if (markerCount < 1)
           document.getElementById("map").style.display = 'none';
    }

    google.maps.event.addDomListener(window, 'load', addMarkers);

</script>

{% endblock %}

{% block left %}

<!--div id="breadcrumbs"><a href="{{ root_url }}">Home</a> / <a href="{{ object.model.url }}">{{ object.model.verbose_name_plural|capfirst }}</a> / {{ object|escape }}</div-->


<h2>{{ object|escape }} | {{object.instance|klass}}</h2>



<table class="objectinfo" style="width: 75%">
<tr class="even"><th style="text-align: right; vertical-align: top; padding-right: 10px;">Record Type:</th><td>{{ object.model.verbose_name|capfirst }}</td></tr>
{% for field in object.fields %}
    {% if field.field.name == "id" %}
    {% else %} {% if field.field.name == "created_date" %}
    {% else %} {% if field.field.name == "modified_date" %}
    {% else %}
        <tr class="{% cycle 'odd' 'even' %}">
        <th style="width: 20%;  text-align: right; vertical-align: top; padding-right: 10px;">{{ field.field.verbose_name|capfirst }}:</th>
        <td>
        {% if field.urls %}
            {% for value, url in field.urls %}
               {% if value %}
                {% if field.field.name == "name" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "professional_title" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "phone" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "email" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "activation_date" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "collection_start_date" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "collection_end_date" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "spatial_explicit" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "rights" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "latitude" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "longitude" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "start_date" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "end_date" %}
                    {{ value|escape }}
                {% else %} {% if field.field.name == "url" %}
                    <a href="{{value}}">{{value|escape}}</a>
                {% else %}
                    {% if url %}<a href="{{url}}">{% endif %}{{ value|escape }}{% if url %}</a>{% endif %}{% if not forloop.last %}, {% endif %}
                {% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}{% endif %}
              {% endif %}
            {% endfor %}
          {% endif %}
        </td>
        </tr>
    {% endif %} {% endif %} {% endif %}
{% endfor %}
</table>

<h2>Related Records</h2>
    {% for related_object in object.related_objects %}
      <div class="related">
       
      {% if related_object.object_list %}
        <b>{{ related_object.object_list.0.model.model|klass }}</b> <br />
          <ul class="objectlist">
            {% for object in related_object.object_list %}
            <li class="{% cycle 'odd' 'even' %}"><a href="{{ object.url }}">{{ object|escape }}</a></li>
            {% endfor %}
          </ul>
      {% endif %}
      </div>
    {% endfor %}
    

{% endblock %}
