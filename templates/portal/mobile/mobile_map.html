<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        
    <title>Main Page</title>
    
    <link rel="stylesheet" href="/portal/media/css/mobile-style.css" />
    <script src="http://code.jquery.com/jquery-1.6.1.min.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0b1/jquery.mobile-1.0b1.min.css" />
    
    <!--  Most Recent Alpha -- the lastest beta does not work with Google Maps -->    
    <script type="text/javascript" src="http://code.jquery.com/mobile/1.0a4.1/jquery.mobile-1.0a4.1.min.js"></script>
    
    {% comment %}
        <script type="text/javascript" src="http://code.jquery.com/mobile/1.0b1/jquery.mobile-1.0b1.min.js"></script>
    {% endcomment %}
</head>
<body>
    <div data-role="page" data-theme="d" id="page-map" style="width:100% !important; height:100% !important;">
        
        <div data-role="header" data-position="fixed">
            <h1>Black Rock Forest</h1>
            {% block header_navigation %}<a href="/portal/mobile/info/" rel="external" data-icon="info">Info</a>{% endblock %}
        </div>
        
        <div data-role="navbar" class="portal_navbar ui-navbar">
            <ul>
                <li><a data-theme="d" href="#page-locate" id="navbar_locate_me" data-icon="custom"></a></li>
                <li><a data-theme="d" href="/portal/mobile/trails/" id="navbar_trails" data-icon="custom"></a></li>
                <li><a data-theme="d" href="#" id="navbar_options" data-icon="custom"></a></li>
                <li><a data-theme="d" href="/portal/mobile/weather/" id="navbar_weather" data-icon="custom" rel="external"></a></li>
            </ul>
        </div>
        
        <div data-role="content" style="width:100% !important; height:100% !important; padding:0 !important;"> 
            <div id="map_canvas" style="width:100% !important; height:100% !important;"></div>
        </div>
    </div>
    
    <div data-role="dialog" data-theme="d" id="page-locate" id="locate">
        <div data-role="content">
            <h3>Location Services</h3>
            <div id="current_position"></div>
            <hr />
            <div data-role="fieldcontain">
                <label for="slider">Locate on Open:</label>
                <select name="slider" id="automatic_update" data-role="slider">
                    <option value="off">Off</option>
                    <option value="on" selected="selected">On</option>
                </select> 
            </div>
            
            <div data-role="fieldcontain">
                <label for="slider">Automatic Update:</label>
                <select name="slider" id="automatic_update" data-role="slider">
                    <option value="off" selected="selected">Off</option>
                    <option value="on">On</option>
                </select> 
            </div>

            <div data-role="fieldcontain">
                <label for="slider">Interval:</label>
                <input type="range" name="slider" id="interval" min="5" max="61" value="10" /> minutes
            </div>
            
            <fieldset class="ui-grid-a">
                <div class="ui-block-a"><input type="button" id="locate_me" value="Locate" data-theme="b"></input></div>
                <div class="ui-block-b"><input type="button" id="cancel" value="Cancel" data-theme="a"></input></div>
            </fieldset>
        </div>
        
    </div>

    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" src="/portal/media/js/mobile-maps.js"></script>
    
    <script type="text/javascript">
        $('#page-map').live("pagecreate", function() {
            alert(".page-map pagecreate");
            portalMapInstance.initialize();

            if (!portalMapInstance.canLocate()) {
                jQuery("#navbar_locate_me").parent().hide();
            }
        });

        $('#page-locate').live("pagebeforeshow", function() {
            alert("page-locate pagebeforeshow");
            if (portalMapInstance.currentPosition) {
                jQuery("#current_position").html(portalMapInstance.currentPosition.getPosition().toString());
            }
        });

        $('#cancel').click(function() {
            jQuery('.ui-dialog').dialog('close'); 
        });

        $('#locate_me').click(function() {
            var interval = jQuery("#interval").attr("value");
            var autolocate = jQuery("#automatic_update").attr("value") == "on";
            portalMapInstance.startLocate(autolocate, interval);
            jQuery('.ui-dialog').dialog('close'); 
            return true;
        });
    </script>
</body>
</html>


